<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Rajdhani:wght@600&display=swap"
      rel="stylesheet"
    />
    <title>moveit canvas</title>
  </head>
  <body>
    <canvas width="1200" height="630"></canvas>
  </body>

  <script>
    class Box {
      /**
       * @param {number} y
       * @param {number} x
       * @param {number} width
       * @param {number} height
       */
      constructor(y, x, width, height) {
        this.top = y;
        this.left = x;
        this.width = width;
        this.height = height;
        //aliases
        this.x = x;
        this.y = y;
        this.w = width;
        this.h = height;
      }

      get right() {
        return this.left + this.width;
      }

      get bottom() {
        return this.top + this.height;
      }
    }

    const level = 23;
    const completedChallenges = 20;
    const XP = 154000;

    const boxAvancei = new Box(102, 160, 408, 427);
    const box_stats = new Box(113, 731, 342, 404);
    const avanceiMiddlePoint = 364;

    const colors = {
      blue1: "#5965E0",
      blue2: "#4953B8",
      green: "#4CD62B",
      red: "#E83F5B",
      blueText: "#B2B9FF",
      titles: "#2E384D",
      texts: "#666666",
      grayLine: "#DCDDE0",
      background: "#F2F3F5",
    };

    function drawCanvas() {
      const img = new Image();
      img.src = "Logo.svg";

      const canvas = document.querySelector("canvas");
      const ctx = canvas.getContext("2d");

      img.onload = () =>
        ctx.drawImage(img, box_stats.left, box_stats.bottom - 50);

      // fundo branco no canvas
      ctx.fillStyle = "white";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // textos alinhados pelo canto superior
      ctx.textBaseline = "top";

      // texto DESAFIOS e EXPERIÊNCIA
      ctx.fillStyle = colors.texts;
      ctx.font = "700 24px Inter";
      ctx.fillText("DESAFIOS", box_stats.x, box_stats.y);
      ctx.fillText("EXPERIÊNCIA", box_stats.x, 264);

      // texto "X Completados" e "Y xp"
      ctx.font = "500 40px Inter";
      const challenges_string = String(completedChallenges);
      const xp_string = String(XP);

      const desafios_medida = ctx.measureText(challenges_string);
      const xp_medida = ctx.measureText(xp_string);

      // completados
      ctx.fillStyle = colors.blue1;
      ctx.fillText(challenges_string, box_stats.left, 152);
      ctx.fillStyle = colors.texts;
      ctx.fillText(
        " completados",
        box_stats.left + desafios_medida.width,
        152
      );

      // xp
      ctx.fillStyle = colors.blue1;
      ctx.fillText(xp_string, box_stats.left, 303);
      ctx.fillStyle = colors.texts;
      ctx.fillText(" xp", box_stats.left + xp_medida.width, 303);

      ctx.lineWidth = 1.5;
      // linha divisória 1
      ctx.strokeStyle = colors.grayLine;
      ctx.moveTo(box_stats.left, 232);
      ctx.lineTo(box_stats.right, 232);
      ctx.stroke();

      // linha divisória 2
      ctx.moveTo(box_stats.left, 383);
      ctx.lineTo(box_stats.right, 383);
      ctx.stroke();

      // Texto Avancei
      ctx.fillStyle = colors.texts;
      ctx.textAlign = "center";
      ctx.font = "600 56px Inter";
      ctx.fillText("Avancei para", avanceiMiddlePoint, 397);
      ctx.fillText("o próximo level", avanceiMiddlePoint, 457); // 397 + line height, que é de 60px

      // número do nível
      ctx.fillStyle = "#5965E0";
      ctx.font = "bold 306px Inter";
      ctx.shadowBlur = 16;
      ctx.shadowOffsetX = 0;
      ctx.shadowOffsetY = 10;
      ctx.shadowColor = "#5965E04D";
      ctx.fillText(String(level), avanceiMiddlePoint, 102);
      // reset shadow
      ctx.shadowColor = "#00000000";
      ctx.shadowBlur = 0;

      const level_measurement = ctx.measureText(String(level));

      // folhas ao lado do nível
      const leafL = new Image();
      leafL.src = "leaf-L.svg";
      const leafR = new Image();
      leafR.src = "leaf-R.svg";

      // tem que refatorar esse código de desenhar imagens
      leafL.onload = () =>
        ctx.drawImage(
          leafL,
          avanceiMiddlePoint -
            leafL.width -
            level_measurement.actualBoundingBoxLeft / 2,
          102
        );
      leafR.onload = () =>
        ctx.drawImage(
          leafR,
          avanceiMiddlePoint + level_measurement.actualBoundingBoxRight / 2,
          102
        );
    }

    drawCanvas();
  </script>

  <style>
    canvas {
      border: 1px solid gray;
      /* width: 600px; */
    }
  </style>
</html>
